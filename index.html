<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Krepšinio turnyro registracija | Mažeikių „Ventos“ progimnazija</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
      background: url('https://upload.wikimedia.org/wikipedia/commons/3/3f/Basketball_court_floor.jpg') no-repeat center center fixed;
      background-size: cover;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.75);
      z-index: -1;
    }
    .logo {
      width: 140px;
      margin-bottom: 10px;
      border-radius: 10px;
    }
    h1 {
      color: #ff8c00;
      text-align: center;
      margin-bottom: 20px;
    }
    .card {
      background-color: rgba(30, 30, 30, 0.95);
      border: 2px solid #ff8c00;
      border-radius: 12px;
      padding: 20px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 15px rgba(255, 140, 0, 0.4);
      margin-bottom: 20px;
    }
    input, select {
      width: 90%;
      padding: 8px;
      margin: 5px 0;
      border: 1px solid #ff8c00;
      border-radius: 6px;
      background-color: #222;
      color: white;
    }
    button {
      background-color: #ff8c00;
      border: none;
      color: white;
      font-size: 16px;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #ffa733;
    }
    table {
      border-collapse: collapse;
      width: 90%;
      max-width: 700px;
      background-color: rgba(30, 30, 30, 0.95);
      border: 2px solid #ff8c00;
      border-radius: 10px;
      margin-top: 20px;
      color: white;
    }
    th, td {
      border: 1px solid #ff8c00;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #ff8c00;
      color: black;
    }
  </style>
</head>
<body>
  <img src="https://upload.wikimedia.org/wikipedia/lt/4/46/Ma%C5%BEeiki%C5%B3_Ventos_progimnazija%2C_logo.png" alt="Ventos progimnazijos logotipas" class="logo">
  <h1>Krepšinio turnyro komandų registracija</h1>

  <div class="card" id="step1">
    <h3>Pasirinkite klasių grupę:</h3>
    <select id="classGroup">
      <option value="">-- Pasirinkite --</option>
      <option value="5–6 klasės">5–6 klasės</option>
      <option value="7–8 klasės">7–8 klasės</option>
    </select><br>
    <button onclick="nextStep()">Tęsti</button>
  </div>

  <div class="card" id="step2" style="display:none;">
    <h3>Komandos informacija</h3>
    <input type="text" id="teamName" placeholder="Komandos pavadinimas"><br>
    <input type="text" id="player1" placeholder="1 žaidėjas"><br>
    <input type="text" id="player2" placeholder="2 žaidėjas"><br>
    <input type="text" id="player3" placeholder="3 žaidėjas"><br>
    <input type="text" id="player4" placeholder="4 žaidėjas"><br>
    <button onclick="submitForm()">Pateikti</button>
  </div>

  <h2 style="margin-top:30px; color:#ff8c00;">Užregistruotos komandos</h2>
  <table id="teamTable">
    <tr>
      <th>Klasių grupė</th>
      <th>Komandos pavadinimas</th>
      <th>Žaidėjai</th>
    </tr>
  </table>

  <script>
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const classGroup = document.getElementById('classGroup');
    const teamTable = document.getElementById('teamTable');
    let selectedGroup = "";

    function nextStep() {
      selectedGroup = classGroup.value;
      if (!selectedGroup) {
        alert('Pasirinkite klasių grupę!');
        return;
      }
      step1.style.display = 'none';
      step2.style.display = 'block';
    }
  </script>

  <!-- Firebase integracija -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

    // -------------------------
    // Įklijuok savo Firebase config čia:
    const firebaseConfig = {
      apiKey: "AIzaSyAiJGMNT8VRK-fvh5Zy5fg3yNDEkqml6Lc",
      authDomain: "krepsinisventa.firebaseapp.com",
      projectId: "krepsinisventa",
      storageBucket: "krepsinisventa.firebasestorage.app",
      messagingSenderId: "788008570675",
      appId: "1:788008570675:web:84b6fc3f8ca5171818b846"
    };
    // -------------------------

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function saveTeam(group, teamName, players) {
      try {
        await addDoc(collection(db, "teams"), {
          group: group,
          teamName: teamName,
          players: players,
          timestamp: new Date()
        });
        console.log("Komanda įrašyta Firebase!");
      } catch (error) {
        console.error("Klaida įrašant į Firebase:", error);
      }
    }

    async function loadTeams() {
      const querySnapshot = await getDocs(collection(db, "teams"));
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        const row = teamTable.insertRow();
        row.insertCell(0).textContent = data.group;
        row.insertCell(1).textContent = data.teamName;
        row.insertCell(2).textContent = data.players.join(', ');
      });
    }

    window.addEventListener('DOMContentLoaded', loadTeams);

    window.submitForm = function() {
      const teamName = document.getElementById('teamName').value.trim();
      const p1 = document.getElementById('player1').value.trim();
      const p2 = document.getElementById('player2').value.trim();
      const p3 = document.getElementById('player3').value.trim();
      const p4 = document.getElementById('player4').value.trim();

      if (!teamName || !p1 || !p2 || !p3 || !p4) {
        alert('Užpildykite visus laukus!');
        return;
      }

      const players = [p1, p2, p3, p4];

      // Įrašome į Firebase
      saveTeam(selectedGroup, teamName, players);

      // Įrašome į lentelę puslapyje
      const row = teamTable.insertRow();
      row.insertCell(0).textContent = selectedGroup;
      row.insertCell(1).textContent = teamName;
      row.insertCell(2).textContent = players.join(', ');

      // Išvalome formą
      document.getElementById('teamName').value = "";
      document.getElementById('player1').value = "";
      document.getElementById('player2').value = "";
      document.getElementById('player3').value = "";
      document.getElementById('player4').value = "";

      alert('Komanda sėkmingai užregistruota!');
      step2.style.display = 'none';
      step1.style.display = 'block';
      classGroup.value = "";
    };
  </script>
</body>
</html>
